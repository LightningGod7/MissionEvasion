#pragma once

#define BOOLIFY(x) !!(x)
#define NT_SUCCESS(Status) (((NTSTATUS)(Status)) >= 0)

typedef struct
{
    IMAGE_DOS_HEADER* pDosHeader;
    IMAGE_NT_HEADERS* pNtHeaders;
    IMAGE_SECTION_HEADER* pSectionHeader;
    IMAGE_DATA_DIRECTORY* pRelocationTable;
    std::unique_ptr<BYTE[]> pFileData;
    DWORD dwFileSize;
} NewProcessInfo;

typedef struct BASE_RELOCATION_BLOCK {
    DWORD PageAddress;
    DWORD BlockSize;
} BASE_RELOCATION_BLOCK, * PBASE_RELOCATION_BLOCK;

typedef struct BASE_RELOCATION_ENTRY {
    USHORT Offset : 12;
    USHORT Type : 4;
} BASE_RELOCATION_ENTRY, * PBASE_RELOCATION_ENTRY;

const unsigned int READ_WRITE_SIZE = 2048;